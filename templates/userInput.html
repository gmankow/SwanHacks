<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Flask Chat with ChatGPT</title>
    <link rel="stylesheet" type="text/css" href="/static/styles.css">
  </head>
  <body>
    <div class="MainPage">
        <div class="title">
            <h1>TEACH MY CHILD, YOU WHORE</h1>
        </div>
        <div class="input">
            <textarea id="input" rows="3" cols="50"></textarea><br />
            
            <div class="send">
                <button onclick="send()">Send</button>
                <pre id="output"></pre>
            </div>
            <h2>Response:</h2>
            <div id="result" style="white-space: pre-wrap; border: 1px solid #ccc; padding: 8px;"></div>
        

    <script>
      async function send() {
        const inputEl = document.getElementById("input");
        const resultEl = document.getElementById("result");
        const message = inputEl.value.trim();

        if (!message) {
          resultEl.textContent = "Please type something first.";
          return;
        }

        resultEl.textContent = "Thinking...";

        try {
          const res = await fetch("/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message }),
          });

          console.log("Status:", res.status);

          const data = await res.json();
          console.log("Data:", data);

          if (data.reply) {
            resultEl.innerHTML = data.reply;
          } else if (data.error) {
            resultEl.textContent = "Error: " + data.error;
          } else {
            resultEl.textContent = "No reply or error field in response.";
          }
        } catch (err) {
          console.error("Fetch error:", err);
          resultEl.textContent = "Request failed: " + err;
        }
      }
    </script>
    </div>
  </body>
</html>
